---
// Página principal refactorizada con componentes SOLID
import Layout from '../layouts/Layout.astro';
import Typography from '../components/ui/Typography.astro';
import Button from '../components/ui/Button.astro';
import BlogCard from '../components/blog/BlogCard.astro';
import { getBlogPosts } from '../lib/blog';

const recentPosts = await getBlogPosts();
const featuredPost = recentPosts[0];
const secondaryPosts = recentPosts.slice(1, 3);
---

<Layout 
  title="Inicio - Muga OS" 
  description="Bienvenido a Muga OS. Un espacio donde compartimos pensamientos, proyectos y experiencias relacionadas con el desarrollo y diseño."
  type="website"
>
  <!-- Hero Section -->
  <section class="px-6 pt-32 flex items-center justify-center text-center" role="banner">
    <div class="text-center">
      <Typography as="h1" variant="title" class="mb-6">
        MUGA OS
      </Typography>
      
      <Typography variant="body" class="max-w-2xl mx-auto mb-8 text-lg">
        Un espacio donde compartimos pensamientos, proyectos y experiencias.
        Todo conectado directamente desde nuestro sistema y procesos.
      </Typography>
      
      <Button 
        href="/blog" 
        variant="primary"
        size="md"
        ariaLabel="Ir al blog para ver todas las publicaciones"
      >
        Ver Blog
      </Button>
    </div>
  </section>

  <!-- Featured Post -->
  {featuredPost && (
    <section class="px-6 py-24" aria-labelledby="featured-post-title">
      <div class="max-w-7xl mx-auto">
        <Typography as="h2" variant="heading" class="sr-only" id="featured-post-title">
          Publicación Destacada
        </Typography>
        
        <BlogCard
          title={featuredPost.data.title}
          slug={featuredPost.slug}
          area={featuredPost.data.area}
          category={featuredPost.data.category}
          status={featuredPost.data.status}
          date={featuredPost.data.date}
          tags={featuredPost.data.tags}
          image={featuredPost.data.image}
          featured={true}
        />
      </div>
    </section>
  )}

  <!-- Secondary Posts -->
  {secondaryPosts && secondaryPosts.length > 0 && (
    <section class="px-6 py-20" aria-labelledby="recent-posts-title">
      <div class="max-w-5xl mx-auto">
        <Typography as="h2" variant="heading" class="sr-only" id="recent-posts-title">
          Publicaciones Recientes
        </Typography>
        
        <div class="space-y-8" role="list" aria-label="Lista de publicaciones recientes">
          {secondaryPosts.map((post) => (
            <div role="listitem" key={post.slug}>
              <BlogCard
                title={post.data.title}
                slug={post.slug}
                area={post.data.area}
                category={post.data.category}
                status={post.data.status}
                date={post.data.date}
                tags={post.data.tags}
                image={post.data.image}
                featured={false}
              />
            </div>
          ))}
        </div>
        
        <div class="text-center mt-16">
          <Button
            href="/blog"
            variant="ghost"
            size="md"
            ariaLabel="Ver todas las publicaciones del blog"
          >
            Ver todas las publicaciones →
          </Button>
        </div>
      </div>
    </section>
  )}

  <!-- No Posts Message -->
  {(!featuredPost && (!secondaryPosts || secondaryPosts.length === 0)) && (
    <section class="px-6 py-16" aria-labelledby="no-posts-title">
      <div class="text-center">
        <div class="diagonal-stripes bg-neutral-900/40 p-12 border border-neutral-800/60 max-w-2xl mx-auto">
          <Typography as="h2" variant="heading" id="no-posts-title" class="mb-2">
            Sin Publicaciones
          </Typography>
          <Typography variant="caption">
            Las publicaciones aparecerán aquí cuando las agregues a la carpeta src/content/blog/.
          </Typography>
        </div>
      </div>
    </section>
  )}
  <style>
    .diagonal-stripes {
      background-image: repeating-linear-gradient(
        -45deg,
        transparent,
        transparent 1px,
        rgba(115, 115, 115, 0.1) 3px,
        rgba(115, 115, 115, 0.1) 10px
      );
    }
  </style>
</Layout>
