---
// Componente BlogPost principal
// Single Responsibility: Renderizar la estructura completa de un post
// Dependency Inversion: Depende de abstracciones (componentes UI)

import Typography from '../ui/Typography.astro';
import Badge from '../ui/Badge.astro';
import LazyImage from '../ui/LazyImage.astro';
import BlogBreadcrumb from './BlogBreadcrumb.astro';
import BlogMetadata from './BlogMetadata.astro';
import BlogTableOfContents from './BlogTableOfContents.astro';

export interface Props {
  title: string;
  area?: string;
  category?: string[];
  status?: string;
  date?: Date;
  tags?: string[];
  image?: string;
  content: string;
}

const {
  title,
  area,
  category = [],
  status,
  date,
  tags = [],
  image,
  content
} = Astro.props;
---

<article class="max-w-4xl mx-auto px-6 py-8" itemscope itemtype="https://schema.org/BlogPosting">
  <!-- Breadcrumb Navigation -->
  <BlogBreadcrumb category={category[0]} />

  <!-- Article Header -->
  <header class="mb-12">
    <Typography as="h1" variant="title" class="mb-8 leading-tight">
      <span itemprop="headline">{title}</span>
    </Typography>

    <!-- Featured Image -->
    {image && (
      <figure class="my-12">
        <LazyImage 
          src={image} 
          alt={`Imagen destacada del artículo: ${title}`}
          class="w-full border border-neutral-700"
          loading="eager"
          decoding="async"
        />
        <figcaption class="text-neutral-400 text-sm mt-4 italic">
          Imagen destacada del artículo
        </figcaption>
      </figure>
    )}

    <!-- Article Metadata -->
    <BlogMetadata 
      area={area}
      status={status}
      date={date}
      tags={tags}
    />
  </header>

  <!-- Table of Contents -->
  <BlogTableOfContents />

  <!-- Article Content -->
  <div 
    class="prose prose-invert prose-neutral max-w-none"
    itemprop="articleBody"
    set:html={content}
  />

  <!-- Article Footer -->
  <footer class="mt-16 pt-8 border-t border-neutral-700">
    <div class="mb-8">
      <Typography as="h2" variant="heading" class="mb-4">
        Créditos y licencia
      </Typography>
      <Typography variant="body" class="mb-4">
        Material y tutorial: MUGA.studio. Publicación orientada a assets gratuitos.
      </Typography>
      <Typography variant="body">
        Licencia sugerida: indicar claramente en la publicación del asset (por ejemplo, uso libre con atribución o similar).
      </Typography>
    </div>

    <Typography variant="caption">
      <time itemprop="dateModified" datetime={date?.toISOString()}>
        Actualizado: {date?.toLocaleDateString('es-ES', {
          year: 'numeric',
          month: 'long',
          day: 'numeric'
        })}
      </time>
    </Typography>
  </footer>
</article>

<style>
  /* Estilos específicos para el contenido del blog */
  .prose {
    color: rgb(212 212 212);
  }
  
  .prose h2 {
    @apply text-2xl font-bold text-white mt-16 mb-8 uppercase tracking-wide;
  }
  
  .prose h3 {
    @apply text-lg font-semibold text-neutral-200 mt-10 mb-4;
  }
  
  .prose p {
    @apply text-lg text-neutral-300 mb-6 leading-relaxed;
  }
  
  .prose ul, .prose ol {
    @apply space-y-4 text-lg text-neutral-300 mb-8;
  }
  
  .prose li {
    @apply leading-relaxed;
  }
  
  .prose strong {
    @apply text-white;
  }
  
  .prose em {
    @apply text-neutral-200;
  }
  
  .prose code {
    @apply bg-neutral-700 px-2 py-1 text-neutral-200;
  }
  
  .prose blockquote {
    @apply bg-neutral-800 p-6 my-8 border-l-4 border-neutral-600;
  }
  
  .prose hr {
    @apply border-neutral-700 my-8;
  }
  
  .prose img {
    @apply w-full border border-neutral-700;
  }
  
  .prose figcaption {
    @apply text-neutral-400 text-sm mt-4 italic;
  }
</style>