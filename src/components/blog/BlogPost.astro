---
import Typography from "../ui/Typography.astro";
import Badge from "../ui/Badge.astro";
import LazyImage from "../ui/LazyImage.astro";
import BlogBreadcrumb from "./BlogBreadcrumb.astro";
import BlogMetadata from "./BlogMetadata.astro";
import TableOfContents, { type TocHeading } from "../TableOfContents.astro";

export interface Props {
  title: string;
  area?: string;
  category?: string[];
  status?: string;
  date?: Date;
  tags?: string[];
  image?: string;
  content: string;
  headings: TocHeading[];
}

const {
  title,
  area,
  category = [],
  status,
  date,
  tags = [],
  image,
  content,
  headings,
} = Astro.props;
---

<article class="max-w-4xl mx-auto px-6 py-8" itemscope itemtype="https://schema.org/BlogPosting">
  <BlogBreadcrumb category={category[0]} />

  <header class="mb-12">
    <Typography as="h1" variant="title" class="mb-8 leading-tight">
      <span itemprop="headline">{title}</span>
    </Typography>

    {image && (
      <figure class="my-12">
        <LazyImage 
          src={image} 
          alt={`Imagen destacada del artículo: ${title}`}
          class="w-full border border-neutral-700"
        />
        <figcaption class="text-neutral-400 text-sm mt-4 italic">
          Imagen destacada del artículo
        </figcaption>
      </figure>
    )}

    <BlogMetadata 
      area={area}
      status={status}
      date={date}
      tags={tags}
    />
  </header>

  <!-- TOC REAL -->
  <TableOfContents headings={headings} />

  <!-- CONTENIDO REAL -->
  <div
    class="prose prose-invert prose-neutral max-w-none"
    itemprop="articleBody"
    set:html={content}
  />

  <footer class="mt-16 pt-8 border-t border-neutral-700">
    <Typography variant="caption">
      <time itemprop="dateModified" datetime={date?.toISOString()}>
        Actualizado: {date?.toLocaleDateString("es-ES", {
          year: "numeric",
          month: "long",
          day: "numeric",
        })}
      </time>
    </Typography>
  </footer>
</article>
